<!DOCTYPE html>
<html>
<head>
  <title>Transmit Token</title>
</head>
<body>
  <script>
    // Helper to get cookie by name
    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(';').shift();
    }

    const token = getCookie('token');
    if (token) {
      const ws = new WebSocket('ws://localhost:8081');
      ws.onopen = () => {
        ws.send(token);
        localStorage.setItem('token', token);
        ws.close();
        window.opener && window.opener.location.reload();
        window.close();
      };
    } else {
      // No token found, redirect or show error
      document.body.innerText = "No token found in cookies.";
    }
  </script>
</body>
</html>